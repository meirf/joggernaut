<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Run Guidance</title>

  <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
  <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
  <link rel="stylesheet" href="/resources/demos/style.css">
  <script>

  var computePathsFresh = function(){
        $.getJSON("http://127.0.0.1:8000/polls/route_solutions/",
        {
           source_node_id: document.getElementById("start_list").value,
           dist_min: document.getElementById("amount-range-dist").value.split("-")[0],
           dist_max: document.getElementById("amount-range-dist").value.split("-")[1],
           elev_min_a: document.getElementById("amount-range-elev-min").value.split("-")[0],
           elev_min_b: document.getElementById("amount-range-elev-min").value.split("-")[1],
           elev_max_a: document.getElementById("amount-range-elev-max").value.split("-")[0],
           elev_max_b: document.getElementById("amount-range-elev-max").value.split("-")[1],
           csrfmiddlewaretoken:'{{ csrf_token }}'
        },
        function(data,status){
          alert("\nStatus: " + status + "\nData: \n" + data.input_status + "\n" + data.response_data);
        })
        .fail(function(xhr) {
            console.log("Error: " + xhr.statusText);
            alert("Error: " + xhr.statusText);
        });
  }

  var updateSliderVals = function(slider_name, left_val, right_val){
        $( slider_name ).val( left_val + "-" + right_val);
  }

  $(function() {
    $( "#slider-range-dist" ).slider({
      step: 5,
      range: true,
      min: 300,
      max: 3000,
      values: [ 1200, 2000 ],
      change: function( event, ui ) {
        updateSliderVals("#amount-range-dist", ui.values[0], ui.values[1]);
        computePathsFresh();
      }
    });
    updateSliderVals("#amount-range-dist" , $("#slider-range-dist").slider("values", 0),
                                            $("#slider-range-dist").slider("values", 1)  );
  });

  $(function() {
    $( "#slider-range-elev-min" ).slider({
      step: 1,
      range: true,
      min: 0,
      max: 100,
      values: [ 0, 20 ],
      change: function( event, ui ) {
        updateSliderVals("#amount-range-elev-min" , ui.values[0], ui.values[1]);
        computePathsFresh();
      }
    });
    updateSliderVals("#amount-range-elev-min" , $("#slider-range-elev-min").slider("values", 0),
                                                $("#slider-range-elev-min").slider("values", 1)  );
  });

  $(function() {
    $( "#slider-range-elev-max" ).slider({
      step: 1,
      range: true,
      min: 0,
      max: 100,
      values: [ 10, 50 ],
      change: function( event, ui ) {
        updateSliderVals("#amount-range-elev-max" , ui.values[0], ui.values[1]);
        computePathsFresh();
      }
    });
    updateSliderVals("#amount-range-elev-max" , $("#slider-range-elev-max").slider("values", 0),
                                                $("#slider-range-elev-max").slider("values", 1)  );
  });
  </script>
</head>
<body>

<p>
  <label for="amount-range-dist">Distance range(meters):</label>
  <input type="text" id="amount-range-dist" style="border:0; color:#f6931f; font-weight:bold;">
</p>

<div id="slider-range-dist"></div>

<p>
  <label for="amount-range-elev-min">Elevation min range(meters):</label>
  <input type="text" id="amount-range-elev-min" style="border:0; color:#f6931f; font-weight:bold;">
</p>

<div id="slider-range-elev-min"></div>

<p>
  <label for="amount-range-elev-max">Elevation max range(meters):</label>
  <input type="text" id="amount-range-elev-max" style="border:0; color:#f6931f; font-weight:bold;">
</p>

<div id="slider-range-elev-max"></div>

<br></br>

<select id="start_list" onchange="computePathsFresh()">
   <option value="-1" >Choose your starting coordinates</option>
   {% for n in nodes %}
       <option value="{{ n.node_id }}">{{ n.latit }}, {{ n.longit }}</option>
   {% endfor %}
</select>

</body>
</html>